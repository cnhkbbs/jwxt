"use strict";const e=require("../../common/vendor.js"),t={data:()=>({host_url:"",feedback_text:"",show_warming:!1,username:"",token:""}),onLoad(){this.host_url=getApp().globalData.host_url,this.loadUserData()},methods:{checkInput(){return this.feedback_text.length<=5?(this.show_warming=!0,!1):(this.show_warming=!1,!0)},loadUserData(){e.index.getStorage({key:"token",success:e=>{this.token=e.data},fail:t=>{e.index.navigateTo({url:"/pages/login/login"})}}),e.index.getStorage({key:"username",success:e=>{this.username=e.data},fail:e=>{console.log("read username fail")}})},submitFeedback(){this.checkInput()&&e.index.request({url:this.host_url+"feedback/",method:"POST",data:{username:this.username,token:this.token,msg:this.feedback_text},header:{"content-type":"application/json"},success:t=>{200!=t.statusCode&&""!=this.token?(e.index.showToast({title:"登录信息过期",icon:"error"}),setTimeout((()=>{e.index.navigateTo({url:"/pages/login/login"})}),1e3)):(e.index.showToast({title:t.data.msg}),setTimeout((()=>{e.index.switchTab({url:"/pages/my/my"})}),1e3))},fail:t=>{e.index.showToast({title:"网络错误",icon:"error"})}})}}};if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const s=e._export_sfc(t,[["render",function(t,s,o,n,i,a){return{a:e.o((e=>i.feedback_text=e)),b:e.p({type:"textarea",placeholder:"写下您的建议或意见吧(●'◡'●)",modelValue:i.feedback_text}),c:i.show_warming,d:e.o(((...e)=>a.submitFeedback&&a.submitFeedback(...e)))}}]]);wx.createPage(s);
