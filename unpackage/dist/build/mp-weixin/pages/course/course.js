"use strict";const e=require("../../common/vendor.js"),t={onLoad(){this.host_url=getApp().globalData.host_url,this.prepareData()},data:()=>({host_url:"",course_lists:[],token:"",username:""}),methods:{async prepareData(){await this.loadUserData(),this.getCourse()},getCourse(){e.index.showLoading({title:"加载中"}),e.index.request({url:this.host_url+"courses/get_courses",method:"POST",data:{token:this.token,username:this.username},header:{"content-type":"application/json"},success:t=>{if(e.index.hideLoading(),200!=t.statusCode&&""!=this.token)e.index.showToast({title:"登录信息过期",icon:"error"}),setTimeout((()=>{e.index.navigateTo({url:"/pages/login/login"})}));else{const e=t.data;this.$set(this,"course_lists",e)}},fail:t=>{e.index.hideLoading(),e.index.showToast({title:"网络错误",icon:"error"})}})},loadUserData(){const t=[];return new Promise(((s,a)=>{let o=this.getStorageData("token","token",t),r=this.getStorageData("username","username",t);Promise.all([o,r]).then((()=>{t.length>0?e.index.navigateTo({url:"/pages/login/login"}):s()})).catch((e=>{console.error("Promise.all failed with error:",e),a(e)}))}))},getStorageData(t,s,a){return new Promise(((o,r)=>{e.index.getStorage({key:t,success:e=>{this[s]=e.data,o()},fail:e=>{a.push(`${t} data retrieval failed.`),o()}})}))}}};const s=e._export_sfc(t,[["render",function(t,s,a,o,r,i){return{a:e.f(r.course_lists,((t,s,a)=>({a:e.t(s+1),b:e.f(t,((t,s,a)=>e.e({a:""===t},""===t?{}:{b:e.t(t)},{c:s}))),c:s})))}}]]);wx.createPage(s);
